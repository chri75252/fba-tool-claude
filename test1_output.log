2025-05-30 16:56:05,436 - __main__ - INFO - Initializing Passive Extraction Workflow...
2025-05-30 16:56:05,993 - __main__ - INFO - OpenAI client initialized with model gpt-4o-mini-2024-07-18
2025-05-30 16:56:05,993 - __main__ - INFO - Loaded linking map from C:\Users\chris\Amazon-FBA-Agent-System\OUTPUTS\FBA_ANALYSIS\Linking map\linking_map.json with 24 entries
2025-05-30 16:56:05,993 - __main__ - INFO - PassiveExtractionWorkflow initialized WITH an AI client.
2025-05-30 16:56:05,993 - amazon_playwright_extractor - INFO - Output directory set to: C:\Users\chris\Amazon-FBA-Agent-System\OUTPUTS\AMAZON_SCRAPE
2025-05-30 16:56:05,994 - __main__ - INFO - Loaded linking map from C:\Users\chris\Amazon-FBA-Agent-System\OUTPUTS\FBA_ANALYSIS\Linking map\linking_map.json with 24 entries
2025-05-30 16:56:05,994 - __main__ - INFO - Loaded linking map with 24 entries
2025-05-30 16:56:05,994 - __main__ - INFO - Running workflow for clearance-king.co.uk with max 1 products. Price range ú0.1-ú20.0.
2025-05-30 16:56:05,994 - __main__ - INFO - Starting passive extraction workflow for supplier: clearance-king.co.uk (https://www.clearance-king.co.uk)
2025-05-30 16:56:05,994 - __main__ - INFO - Session ID: clearance-king_co_uk_20250530_165605
2025-05-30 16:56:05,994 - __main__ - INFO - PRICE CRITERIA: Min Supplier Cost ú0.1, Max Supplier Cost ú20.0
2025-05-30 16:56:05,994 - __main__ - INFO - Resuming from index 2 (previous run state found)
2025-05-30 16:56:05,995 - __main__ - INFO - Loaded 17 products from supplier cache (0.0 hours old)
2025-05-30 16:56:05,995 - __main__ - INFO - STAGE-COMPLETE: supplier_scrape - 17 records
2025-05-30 16:56:05,995 - __main__ - INFO - Successfully got 17 products from clearance-king.co.uk
2025-05-30 16:56:05,995 - __main__ - INFO - Found 17 valid supplier products, 17 within price range [ú0.1-ú20.0]
2025-05-30 16:56:05,995 - __main__ - INFO - STAGE-COMPLETE: price_filtering - 17 records
2025-05-30 16:56:05,995 - __main__ - INFO - Processing up to 1 products starting from index 2.
2025-05-30 16:56:05,995 - __main__ - INFO - --- Processing supplier product 1/1: 'Glamorize Root Touch-Up - Shade 5 - Dark Brown - EXP: 04/23' (EAN: 5056175922222) ---
2025-05-30 16:56:05,996 - __main__ - INFO - Attempting Amazon search using EAN: 5056175922222
2025-05-30 16:56:05,996 - __main__ - INFO - Connecting to Chrome browser on debug port 9222 (FixedAmazonExtractor)
2025-05-30 16:56:07,008 - __main__ - INFO - Successfully connected to Chrome on port 9222 (FixedAmazonExtractor)
2025-05-30 16:56:07,008 - __main__ - INFO - Found 4 existing pages (FixedAmazonExtractor)
2025-05-30 16:56:07,008 - __main__ - INFO - Using existing page: https://www.amazon.co.uk/s?k=D%26K+Dengke+Cup+Shape+Glass+Pipe+%2B+Screen&ref=nb_sb_noss (FixedAmazonExtractor)
2025-05-30 16:56:07,019 - __main__ - INFO - Searching Amazon by EAN: 5056175922222 for supplier product: 'Glamorize Root Touch-Up - Shade 5 - Dark Brown - EXP: 04/23' (FixedAmazonExtractor)
2025-05-30 16:56:07,023 - __main__ - INFO - Navigating to Amazon UK to search for EAN: 5056175922222
2025-05-30 16:56:09,633 - __main__ - INFO - Waiting for search results page to load for EAN 5056175922222...
2025-05-30 16:56:10,008 - __main__ - INFO - Found search results container with selector: div.s-search-results
2025-05-30 16:56:12,097 - __main__ - INFO - Found 7 search result elements using selector: div.s-result-item[data-asin]:not([data-asin=''])
2025-05-30 16:56:12,097 - __main__ - INFO - Processing 7 search result elements for EAN 5056175922222
2025-05-30 16:56:12,170 - __main__ - INFO - Skipping sponsored result: ASIN B0BLXT5HMX (detected by ad-specific class: 'AdHolder')
2025-05-30 16:56:12,201 - __main__ - INFO - Skipping sponsored result: ASIN B0DPN8NMX8 (detected by ad-specific class: 'AdHolder')
2025-05-30 16:56:12,231 - __main__ - INFO - Skipping sponsored result: ASIN B006ZDQIMA (detected by ad-specific class: 'AdHolder')
2025-05-30 16:56:12,252 - __main__ - INFO - Skipping sponsored result: ASIN B084L1LTVZ (detected by ad-specific class: 'AdHolder')
2025-05-30 16:56:12,331 - __main__ - INFO - Skipping sponsored result: ASIN B008D5HAHU (detected by ad-specific class: 'AdHolder')
2025-05-30 16:56:12,446 - __main__ - INFO - Skipping sponsored result: ASIN B01M63JLV4 (detected by ad-specific class: 'AdHolder')
2025-05-30 16:56:12,479 - __main__ - INFO - Skipping sponsored result: ASIN B0D62ZG4ZL (detected by ad-specific class: 'AdHolder')
2025-05-30 16:56:12,479 - __main__ - WARNING - EAN 5056175922222 returned no organic results - skipping
2025-05-30 16:56:12,479 - __main__ - WARNING - No Amazon results or error for EAN '5056175922222'. Details: no_organic_results
2025-05-30 16:56:12,479 - __main__ - WARNING - EAN search for '5056175922222' failed or returned error: No results for EAN 5056175922222 or search error
2025-05-30 16:56:12,480 - __main__ - INFO - EAN search failed for 'Glamorize Root Touch-Up - Shade 5 - Dark Brown - EXP: 04/23'. Falling back to title search.
2025-05-30 16:56:12,480 - __main__ - INFO - Searching Amazon by title using search bar: 'Glamorize Root Touch-Up - Shade 5 - Dark Brown - EXP: 04/23'
2025-05-30 16:56:12,485 - __main__ - INFO - Navigating to Amazon UK to search for title: Glamorize Root Touch-Up - Shade 5 - Dark Brown - EXP: 04/23
2025-05-30 16:56:15,825 - __main__ - INFO - Title search found 1 elements using selector: div.s-search-results > div[data-asin]
2025-05-30 16:56:15,834 - __main__ - WARNING - No valid ASINs found for title 'Glamorize Root Touch-Up - Shade 5 - Dark Brown - EXP: 04/23'
2025-05-30 16:56:15,834 - __main__ - WARNING - No Amazon results for title 'Glamorize Root Touch-Up - Shade 5 - Dark Brown - EXP: 04/23'. Skipping. Details: No valid ASINs found for title 'Glamorize Root Touch-Up - Shade 5 - Dark Brown - EXP: 04/23'
2025-05-30 16:56:15,834 - __main__ - INFO - STAGE-COMPLETE: triage_stage - 0 passed, 0 rejected
2025-05-30 16:56:15,834 - __main__ - WARNING - STAGE-GUARD WARNING: Triage stage rejected all 1 products. Check SellerAmp connectivity or criteria.
2025-05-30 16:56:15,834 - __main__ - INFO - STAGE-COMPLETE: deep_extraction - 0 successful extractions, 0 errors
2025-05-30 16:56:15,834 - __main__ - INFO - STAGE-COMPLETE: profitable_filtering - 0 profitable products found
2025-05-30 16:56:15,834 - __main__ - INFO - No profitable products found meeting all criteria in this run.
2025-05-30 16:56:15,835 - __main__ - INFO - Workflow summary saved to C:\Users\chris\Amazon-FBA-Agent-System\OUTPUTS\FBA_ANALYSIS\fba_summary_clearance-king_co_uk_20250530_165605.json
2025-05-30 16:56:15,835 - __main__ - INFO - \U0001f4cb Session Summary: 2 products analyzed, 0 profitable products found
2025-05-30 16:56:15,837 - __main__ - INFO - Successfully saved linking map with 24 entries to C:\Users\chris\Amazon-FBA-Agent-System\OUTPUTS\FBA_ANALYSIS\Linking map\linking_map.json
2025-05-30 16:56:15,837 - __main__ - INFO - Persistent linking map updated with 24 entries
2025-05-30 16:56:15,837 - __main__ - INFO - Running FBA_Financial_calculator run_calculations...
2025-05-30 16:56:16,369 - __main__ - ERROR - Error running FBA_Financial_calculator: name 'workflow_instance' is not defined
2025-05-30 16:56:16,370 - __main__ - INFO - Workflow completed. No profitable products found.
2025-05-30 16:56:16,370 - __main__ - INFO - Running FBA_Financial_calculator run_calculations...
2025-05-30 16:56:16,387 - __main__ - INFO - FBA financial report generated at: C:\Users\chris\Amazon-FBA-Agent-System\OUTPUTS\FBA_ANALYSIS\fba_financial_report_20250530_165616.csv
2025-05-30 16:56:16,387 - __main__ - INFO - Amazon extractor browser connection intended to be kept open.
2025-05-30 16:56:16,387 - __main__ - INFO - Web scraper session closed.
2025-05-30 16:56:16,387 - __main__ - INFO - Main workflow execution finished.
================================================================================
Amazon FBA Passive Extraction Workflow
Version: 1.0.3 - 2025-05-30
Output Directory: C:\Users\chris\Amazon-FBA-Agent-System\OUTPUTS\FBA_ANALYSIS
Using FixedAmazonExtractor for improved extension compatibility.
Profitability Criteria: Min ROI 35.0%, Min Profit ú3.0
================================================================================
Processing 17 supplier products...
Loaded persistent linking map with 24 entries
Found Amazon data via linking map: EAN_5056175922239 -> B0D31RM328
Found Amazon data via linking map: EAN_5055257878532 -> B01LX41P0D
Found Amazon data via linking map: EAN_5055257877009 -> B002TIEDAO
Found Amazon data via linking map: EAN_5050375947825 -> B0DYV8W1YL
Found Amazon data via linking map: EAN_5020535010997 -> B07RM4PZC3
Found Amazon data via linking map: EAN_5060120173799 -> B08BZY43XF
Found Amazon data via linking map: EAN_5053249240312 -> B08B1P9KWC
Found Amazon data via linking map: EAN_5031413923490 -> B0D47ZBB59
Found Amazon data via linking map: EAN_5060120163547 -> B01CC0GEEG
Found Amazon data via linking map: EAN_05060072087823 -> B094KH8CDR
Found Amazon data via linking map: EAN_5060120164131 -> B00V2DJHKI
No price found for: EAN=5060120164131, ASIN=None, Title=Xpel Brand - Argan Oil Hydrating Hair Mask - Vegan - 220Ml - EXP: 09/25
Found Amazon data via linking map: EAN_5060120163714 -> B004FIYZ0Y
Found Amazon data via linking map: EAN_5060120163363 -> B01MCYQF2P
Exception ignored in: <function _ProactorBasePipeTransport.__del__ at 0x000002368E64F100>
Traceback (most recent call last):
  File "C:\Python313\Lib\asyncio\proactor_events.py", line 116, in __del__
    _warn(f"unclosed transport {self!r}", ResourceWarning, source=self)
  File "C:\Python313\Lib\asyncio\proactor_events.py", line 80, in __repr__
    info.append(f'fd={self._sock.fileno()}')
  File "C:\Python313\Lib\asyncio\windows_utils.py", line 102, in fileno
    raise ValueError("I/O operation on closed pipe")
ValueError: I/O operation on closed pipe
Exception ignored in: <function BaseSubprocessTransport.__del__ at 0x000002368E64D760>
Traceback (most recent call last):
  File "C:\Python313\Lib\asyncio\base_subprocess.py", line 129, in __del__
    _warn(f"unclosed transport {self!r}", ResourceWarning, source=self)
  File "C:\Python313\Lib\asyncio\base_subprocess.py", line 73, in __repr__
    info.append(f'stdin={stdin.pipe}')
  File "C:\Python313\Lib\asyncio\proactor_events.py", line 80, in __repr__
    info.append(f'fd={self._sock.fileno()}')
  File "C:\Python313\Lib\asyncio\windows_utils.py", line 102, in fileno
    raise ValueError("I/O operation on closed pipe")
ValueError: I/O operation on closed pipe
Exception ignored in: <function _ProactorBasePipeTransport.__del__ at 0x000002368E64F100>
Traceback (most recent call last):
  File "C:\Python313\Lib\asyncio\proactor_events.py", line 116, in __del__
    _warn(f"unclosed transport {self!r}", ResourceWarning, source=self)
  File "C:\Python313\Lib\asyncio\proactor_events.py", line 80, in __repr__
    info.append(f'fd={self._sock.fileno()}')
  File "C:\Python313\Lib\asyncio\windows_utils.py", line 102, in fileno
    raise ValueError("I/O operation on closed pipe")
ValueError: I/O operation on closed pipe
